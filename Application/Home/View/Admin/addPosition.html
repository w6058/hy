<layout name="Layout/layout_admin" />

<section class="page-content">
<div class="page-content-inner">

    <!-- Basic Form Elements -->
    <section class="panel">
        <div class="panel-heading">
            <h3>新增管理员页面</h3>
        </div>
        <div class="panel-body">
            <div class="row">
                <div class="col-lg-12">
                    <div class="margin-bottom-50">
                        <p style="color: red;text-align: center;">{{$info}}</p>
                        <br />
                        <form method="post" action="__MODULE__/admin/addPosition2" enctype="multipart/form-data">
                            <div class="form-group row">
                                <div class="col-md-2 col-lg-offset-1">
                                    <label class="form-control-label">职位名称</label>
                                </div>
                                <div class="col-md-6">
                                    <input type="text" class="form-control" name="p_name" placeholder="职位名称">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-2 col-lg-offset-1">
                                    <label class="form-control-label">职位权限</label>
                                </div>
                                <div class="col-md-6">
                                    <input type="text" readonly="readonly" class="form-control" name="content" placeholder="职位权限">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-2 col-lg-offset-1">
                                    <label class="form-control-label">权限增减</label>
                                </div>
                                <div class="col-md-6">
                                   <select name="selvalue" class="form-control">
                                        <option value="1">选择权限</option>
                                        <foreach name='restrict' item='v'>
                                            <option value="{{$v.r_name}}">{{$v.r_name}}</option>
                                        </foreach>
                                    </select>
                                </div>
                            </div>
                            <div class="form-actions">
                                <div class="form-group row">
                                    <div class="col-md-6 col-md-offset-3">
                                        <button type="submit" class="btn width-150 btn-primary">添加</button>
                                        <a href="__MODULE__/admin/position" class="btn btn-default">返回</a>
                                    </div>
                                </div>
                            </div>
                        </form>
                        <!-- End Horizontal Form -->
                    </div>
                </div>
            </div>


        </div>
    </section>
    <!-- End -->

</div>
<script>
    $("select").on('change',function(){
        var self = $(this);
        var inpVal = $("input[name='content']").val();
        var arr = inpVal.split('/');
        if ($(this).val() != 1) {
            if (arr[0] != "") {
                var rel;
                    arr.forEach(function(value, index, arr){
                        if (value == self.val()) {
                            rel = index;
                        }
                    })
                if (rel != undefined) {
                    var a = arr.splice(rel, 1);
                }else{
                    arr.push($(this).val());
                }
            }else{
                arr[0] = $(this).val();
            }
            var arr1 = arr.join("/");
            console.log(arr1);
            $("input[name='content']").val(arr1);
        }
    })
    $("button").on('click',function(){
        var p_name = $("input[name='p_name']").val();
        var content = $("input[name='content']").val();
        if (p_name == "") {
            $("button").attr('type','button');
            window.alert('请输入职位名称。');
        }else if(content == ""){
            $("button").attr('type','button');
            window.alert('请选择职位权限。');
        }else{
            $("button").attr('type','submit');
        }
    })
</script>
</section>

